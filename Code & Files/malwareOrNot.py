import pickle
import pandas as pd
from sklearn.metrics import mean_absolute_error


def detect():
    with open("saveModel.pkl", "rb") as f:
        model, select, data_train, data_test, value_train, value_test , mean_features = pickle.load(f)


    test = pd.read_csv("output.csv", sep=',')
    # test = test.dropna(axis=0)
    test = test.drop(["Name", "md5"], axis=1).values
    test = select.transform(test)
    print(test)
    print(test.shape)
    print(data_test.shape)

    label_prediction = model.predict(test)
    print("Prediction: ", label_prediction)
    if label_prediction == 1:
        print("Not Malware...!!!")
        return 1;
    else:
        print("Malware...!!!")
        return 0;
    # label_mae = mean_absolute_error(mal_test, label_prediction)
    # print("The mae value: ", label_mae*100)
    # print("The score of the algorithm is: ", model.score(legit_test, mal_test)*100)
